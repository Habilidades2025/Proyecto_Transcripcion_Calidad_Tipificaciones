# Transcripción: local con Faster-Whisper, Deepgram o OpenAI
TRANSCRIBE_PROVIDER=deepgram
# NUEVO: la ruta usa STT_PROVIDER; mantenlos alineados
STT_PROVIDER=deepgram

# OpenAI
OPENAI_API_KEY=tu apikey
OPENAI_TRANSCRIPTION_MODEL=whisper-1
OPENAI_CHAT_MODEL=gpt-4o-mini
OPENAI_TIMEOUT_MS=600000
ANALYSIS_MAX_INPUT_CHARS=200000
ANALYSIS_MAX_TOKENS=7000
ANALYSIS_BATCH_SIZE=20
ANALYSIS_BATCH_TOKENS=1000

# Deepgram
DEEPGRAM_API_KEY=tu apikey
DEEPGRAM_MODEL=nova-3
DEEPGRAM_LANG=es-419
DEEPGRAM_FALLBACK_OPENAI=1

# Red (evita proxy para loopback)
NO_PROXY=127.0.0.1,localhost

# Si pones 1, la transcripción SE guarda dentro del JSON (más grande)
# Si pones 0, se guarda en /data/transcripts/YYYY/MM/<id>.txt y el JSON solo referencia la ruta
STORE_TRANSCRIPT_INLINE=0
REPORT_INCLUDE_DETAILS=0
BLOCK_SUMMARY_USE_LLM=1

#Ajustes para que cree carpetas por día
AUDITS_BY_DAY=1
FILES_TZ=America/Bogota

# Parametrización calificación de matriz de calidad
ANALYZE_ONLY_CRITICAL=1
SCORING_NORMALIZE_TO_100=1
CRITICAL_WEIGHT_VALUE=100
CRITICAL_NAME_KEYWORDS=tratamiento de datos,habeas data,autorización datos,consentimiento,legal,ley 1581
CRITICAL_CATEGORY_KEYWORDS=crítico,critico,legal,obligatorio,compliance
STRICT_APPLICA=1
EXPOSE_CRIT_ARRAYS=1

# Criticidad (alinear todos los módulos)
CRITICAL_BY_WEIGHT=1
CRITICAL_WEIGHT_THRESHOLD=100

# --- Fraude (ajústalo a tus canales reales) ---
# Esto se usa para "mostrar" los canales en el prompt del análisis
OFFICIAL_PAY_CHANNELS=059034801, 17800001445, 17800001670, efecty convenio 10860, 17800000934

# NUEVO: fuentes de verdad para validar números/códigos oficiales (usadas por heurística antifraude)
CP_OFFICIAL_BANK_ACCOUNTS_JSON=[{"bank":"AV VILLAS","type":"ahorros","number":"059034801","holder":"P.A FTP NOVARTEC SAS","nit":"830054539"},{"bank":"BANCOLOMBIA","type":"ahorros","number":"17800001445","holder":"PA FIDUCIARIA BANCOLOMBIA SA SOCIEDAD FIDUCIARIA","nit":"830054539","tags":["nequi","daviplata"]},{"bank":"BANCOLOMBIA","type":"corriente","number":"17800000934","holder":"NOVARTEC S.A.S","nit":"901507911"}]
CP_OFFICIAL_CONVENIOS_JSON=[{"network":"efecty","convenio":"10860","holder":"Cartera Contacto"}]

# Ayudas para identificar el agente/cliente en la llamada
AGENT_COMPANY_HINTS=novartec,vartex,contacto solution,contacto solucion

DEBUG_PROMPT=0
DEBUG_ANALYSIS_PROMPT=0
DEBUG_PROMPT_PREVIEW_CHARS=2000

# Límite de archivos por subida (el uploader ahora soporta 200 por defecto)
UPLOAD_MAX_FILES=200

# Tamaño máximo por archivo (100 MB). Ajusta si tu audio es más pesado.
UPLOAD_MAX_FILE_SIZE=104857600

# Para 200 audios, recomendamos usar disco temporal en lugar de memoria
UPLOAD_USE_DISK=1
UPLOAD_DISK_DIR=tmp/uploads

# Concurrencia real de procesamiento (hilos/slots simultáneos de transcribir+analizar)
# Sube/baja según tu CPU, RAM y límites de las APIs (8–12 suele ir bien)
BATCH_MAX_PARALLEL=12

# Keepalive del SSE para la barra de progreso en UI
SSE_KEEPALIVE_MS=15000

# Emitir alertas de fraude una sola vez por llamada (evita duplicados en reintentos)
FRAUD_ALERTS_ONCE=1

# (Opcional) Si necesitas más memoria en Node para lotes grandes, puedes lanzar con:
# NODE_OPTIONS=--max-old-space-size=6144
